[package]
name = "strict-path"
version = "0.1.0-rc.2"
edition = "2021"
# Minimum supported Rust version (MSRV)
rust-version = "1.71"
authors = ["David Krasnitsky <dikaveman@gmail.com>"]
description = "Handle paths from external or unknown sources securely. Minimal, restrictive, explicit API. Mathematically proves paths stay within boundaries using Rust's type system. StrictPath detects escapes, VirtualPath contains them. Handles symlinks, 19+ CVEs, Windows 8.3 names, Linux containers."
license = "MIT OR Apache-2.0"
repository = "https://github.com/DK26/strict-path-rs"
homepage = "https://github.com/DK26/strict-path-rs"
documentation = "https://docs.rs/strict-path"
# Complete guide and examples: https://dk26.github.io/strict-path-rs/
readme = "../README.md"
keywords = ["path", "security", "sandbox", "filesystem", "traversal"]
categories = ["filesystem", "development-tools", "web-programming::http-server"]
# The path is now relative to the workspace root
exclude = ["../demos/**"]

[dependencies]
# Using DK26 fork dev branch which contains junction prefix mismatch workaround
# TODO: Switch back to upstream `soft-canonicalize = "0.5.3"` after changes are released
soft-canonicalize = { git = "https://github.com/DK26/soft-canonicalize-rs", branch = "dev", features = [
    "anchored",
] }

[dev-dependencies]
tempfile = "3.22"
serde = { version = "1", features = ["derive"] }
serde_json = "1"
dirs = "6.0.0"
app-path = "1.1.2"

# Windows test helper: junctions for symlink tests when admin privileges unavailable
# Using DK26 fork which fixes tesuji/junction#30 (verbatim prefix handling)
# TODO: Switch back to upstream `junction = "1.4"` after tesuji/junction#31 is merged
[target.'cfg(windows)'.dev-dependencies]
junction = { git = "https://github.com/DK26/junction" }

# Optional Windows junction support for the library API
# TODO: Switch back to upstream `junction = "1.4"` after tesuji/junction#31 is merged
[target.'cfg(windows)'.dependencies]
junction = { git = "https://github.com/DK26/junction", optional = true }

[features]
# Opt-in virtual filesystem support (VirtualRoot, VirtualPath)
default = []
virtual-path = []
# Windows-only: enable built-in junction creation helpers using the `junction` crate
junctions = ["dep:junction"]

[package.metadata.docs.rs]
all-features = true

[[example]]
name = "user_virtual_root"
path = "examples/user_virtual_root.rs"
required-features = ["virtual-path"]

[[example]]
name = "vroot_one_liner"
path = "examples/vroot_one_liner.rs"
required-features = ["virtual-path"]
